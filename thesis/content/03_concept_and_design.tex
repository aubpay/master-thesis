\chapter{Concept and Design}
\label{cha:conceptanddesign}

As stated in the research statement, the goal of this thesis is to come up with a solution that solves the unpaid content problem. During the first phase of this research, several opportunities are explored. This chapter gives a chronological overview of these explorations and describes the final model in detail.

\section{Privacy preserving ad network}
In the beginning, the main focus laid at privacy issues that are coming with the use of ad networks. In order to solve this issue, a concept is created where the tracking and profile building moved from the ad network to the browser of the user. By using such an approach, the ad network does not know your browsing history and might even benefit from the new approach, because the browser is able to build a profile that is much more accurate. 

The problem with this concept is actively being researched. For example, it implemented in the Privad system, which can be found in section \ref{sec:privad} system and the Brave browser, which is discussed in section \ref{sec:brave}. Therefore, this concept is abandoned in an early stage.

\section{Universal automated payment solution}
The second concept goes one step further. This concept is not about replacing the ad network with a privacy friendly alternative, but making the entire ad network obsolete. As discussed in chapter \ref{cha:relatedwork}, the problem with ad networks is that is one of the few revenue models that actually works on the internet.

Several commercial experiments are performed using micropayments, however, as stated in chapter \ref{cha:relatedwork}, very few of them are successful. Mainly because of the mental transaction cost that comes with the purchase of online content. In order to solve this issue, the concept of automated payments is introduced. This approach applies the advantage of web advertisements (no browsing interruption) with the benefit of micropayments (no ads). It might also be explained as a fair ad blocker. No ads, but also taking care of the revenue of the publisher. The goal of this concept is to offer such a system with as minimal configuration as possible.
\vspace{2em}

Concept: \textit{Distribute a small amount of money over the publishers that you visit and hide the advertisements}

\vspace{2em}

Potential challenges:
\begin{enumerate}
  \item How to keep the configuration as minimal as possible?
  \item What design can be applied to operate the system in a decentral way?
  \item How to determine the amount of contribution?
  \item How to prevent fraud?
\end{enumerate}

\subsection{WebRTC approach}
\label{sec:webrtc}
In order to stick to the zeroconf principle, the system should work out of the box, no configuration needed, this first approach includes WebRTC. WebRTC is a system that enables two browsers to create a peer to peer connections to eachother.

This concept assumes that there is a system running that handles all the automated payments to the publisher. The first problem that needs to be solved is: how does the website communicate with the system. Installing an add-on in the browser would violate the zeroconf principle, so this approach uses WebRTC as a message bus. Why WebRTC, you might ask? As WebRTC makes it possible for browsers to communicate with eachother, it is also possible to let different websites communicate to eachother in the same browser. Normally, this is not so easy because every website runs in a sandboxed environment. For example, if \textit{derspiegel.de} want to communicate with a system on \textit{payjs.io}, that is only possible if there is a link between both websites, such as an iframe or that one of the websites opened a tab to the other one. 

WebRTC connects to an ip address, so what happens if we connect to localhost? Is it possible to let two websites communicate without a link between them? The WebRTC is indeed able to connect to localhost, but in order to do so, a handshake is needed \cite{dutton2013webrtc}. This handshake, however is not specified in the WebRTC protocoll. This means that system can implement its own way of doing so. WebRTC-systems that are applied on the internet are mostly relying on a signaling server, which forwards the handshake. 

During this research, several experiments are performed using WebRTC. Unfortunately, the experiments turned out that it is not possible to connect two websites within one browser directly. A signaling server that is run by a third party stays neccesary. This would introduce a privacy problem, because the third party would be able to find out which publisher is visited from which ip. Therefore, this concept is abandoned in an early stage.
\subsection{Lightning network}

The aproach above, however, does not include any form of payment. In the first stage, the scope is limited to a universal payment system, without taking care of the payment itself. It is assumed that there is a cryptocurrency solution that can be attached to the universal payment system.

Fortunately, parallel to this research, a micropament solution based on the Bitcoin blockchain is being actively developed. This so-called Lightning Network is discussed in section \ref{sec:lightning} in more detail. The goal of this system is to provide instant micropayments at minimal costs, which is ideal an automated payment solution.

From the concept point of view, the payment part is a matter of communicating with an API. Nonetheless, are there still some issues with the Lightning Network so that it is not ready to use. One of the main disadvantages of the Lightning Network is that it is not possible to send a transaction to an address directly. By design, a payment should be requested by issuing an invoice. This invoice is written according to a standard format and can be paid using any Lightning Network client. This invoice-based structue suboptimal for the usecase that is needed for this research.

\subsection{Localhost approach}

As the concept where WebRTC is applied in order to let the publisher communicate with the system is not viable, this research is extended to other approaches. One approach that is used by other websites to communicate with the users' computer is by running a webserver. This webserver can be accessed from any website by connecting to localhost. For example, the popular video conferencing application Zoom uses this approach so that the application gets opened when a user visits a meeting url \cite{zoomwebserver}.

As this concept is built in combination with the Lighting Network, there needs to be an application running on the users' computer anyway. So, this makes it possible to develop one service needs to be installed which both acts like a lightning network client and an interface on localhost to the website that requests a payment.

\subsection{Dynamic contribution}

One of the challeges of this concept is to pay a fair share to the publisher. How to determine the amount that is contributed? The general idea is that the amount should be in the same order of magnitude as the revenue when an online advertisement is displayed. Such a display is called an impression in online advertising jargon. The price of such an impression is determined as Price-per-mille (CPM), the price for 1,000 impressions. If a user clicks on an advertisement, the fee is called the cost-per-click (CPC). The amount of users that clicks on the advertisment is expressed in click-throug-rate (CTR) \cite{evans2009online}. For the Google Display Network (which also includes services like Gmail), the following average numbers are available for the first quarter of 2018: 

\begin{itemize}
  \item CPM: 2.80 USD
  \item CPC: 0.75 USD
  \item CTR: 0.35\%
\end{itemize}

\noindent With this data, it is possible to calculate the average revenue per served ad, which is:

\begin{equation}
\cfrac{CPM}{1000} + CTR \times CPC = \cfrac{2.80}{1000} + 0.75 \times 0.0035 = 0.005425 ~\text{USD}
\end{equation}

\noindent In order to estimate the online ad revenue per user per month, this revenue is multiplied with the average amount of ads that are served to a user, which is around 1,700 \cite{papadopoulos2018cost}. 

\begin{equation}
  \text{revenue per ad} \times \text{impressions per month} = 0.005425 \times 1,700 = 9.22 ~\text{USD}
\end{equation}
This gives us an average revenue per internet user of USD per month and does not include the margin of the advertising networks, which is somewhere between 20 and 50 percent. For the Google Display Network it is 32 percent \cite{googlefee}. If we cut this fee from the calculation above, the remaining profit for all publishers will be:


\begin{equation}
  \text{revenue per month} \times (\text{1 -- ad network fee}) = 9.22 \times (1 - 0.32) = 6.26 ~\text{USD}
\end{equation}


This net profit per internet user per month will be the basis for the pricing model of this concept. By using these number, there should be no difference between targeted advertising and this concept in terms of revenue for the publisher.

The next question that needs to be anwered is: how to distribute this amount over the publishers in a manner that is fair.  




\subsection{Wallet address listing}

As described in the Lightning Network concept, there is a possibility to send micropayments to a publisher. The challenge in this case is, how to communicate the wallet address of the publisher to the users' computer? Of course, it is possible to just store it somewhere in a javascript variabele. But some websites are executing user generated content, for example: it is possible to host a website with javascript content on \textit{github.io}. It is not desirable that a fraudulent party spams javascript snippets over the internet that asks for an automated payment without contributing to valueable content. 

One aspect of websites is barely modified by user generated content: DNS records. DNS records are only modifyable by the owner of the domain name, which is in most cases the publisher. One way of storing information in DNS records is to just create a subdomain that contains the content: in this case, the wallet address of the publisher. 

Fortunately, the DNS specification also features a so-called TXT record. This is a record that does not affect the way the domain name is resolved. However, it can be queried and used by other applications. For the automated payment design, the TXT record will be used by the system to provide the wallet address of the publisher, so that it cannot be modified by someone else, other than the owner of the domain name. 

\subsection{Self-signed, DV, OV and EV certificates}

One of the problems with an automated payment system is: how can be determined if a publisher is trustworthy? For example: what happens if some malicious publisher buys a bunch of domain names and opens 50 tabs on the users' computer? Does the system make a payment to all of those 50 domains? 

One approach would be to assign one party that is able to determine which publisher is trustworthy and which one is not. This would violate the decentral principle and is therefore not desirable. Another approach that is discussed is to calculate some kind of score, such as pagerank, and use this score to value the credibility of the publisher. Based on this credibility, a payment might be made or might be adjusted. For example: the domain name \textit{spiegel.de} has a pagerank score of 8/10 where \textit{gartenforum.de} has a pagerank score of 3/10. However, this does not indicate the trustworthyness of a publisher. There is no legitimate reason to pay more to a big publisher that to a small independant content creator. 

Fortunately, there is already a worldwide decentral system in place that validates credibility of websites: SSL certificates. SSL certificates, that are needed in order to establish an encrypted connection to a website are also applied to make sure that the user is communicating with the website that it pretents to be. In order to understand this concept, a short introduction to the different types of certificates and architecture is given. First, a certificate needs to be issued by an authority. The credibility of the certifcate is based on this credibility of the issuer. If some publisher issues the certificate by themselves, it is called a self-signed certificate and this provides no creditbility other than that the connection is encrypted, but there is no guarantee that the party on the other end of the line is the party that they are pretending to be. If the issuer is a trusted party, the certifciate is called a certification authority (CA) certifciate. These CA's are trusted by the browser or SSL library, and they are doing a couple of background checks before they are issuing a certificte. The level of background checks is dependent on the type of certifciate. 

The least secure type of CA certificate is the Domain Validation (DV) certificate. These certificates are available for free and can be used by anyone that owns a domain name. Therefore, a DV certificate does not say anything about the credibility of the publisher. A fraudulent party is able to register a bunch of domain names and also apply for certificates.

A more secured certificate is the Organization Validation (OV) certificate, also known as a High Assurance certificate. With this type of certificate, the issuer does some background in advance. These background checks include the verification of the information in a third party database, such as a companies house. One other aspect of these certificates is that they are not free, which means that it is less easy to register a bunch of domain names. Major publishers, such as \textit{spiegel.de} are using these OV certificates.

As an extension to the OV certificate, there is also an Extended Validation certification. In the past, this type of certificate was popular amongs banks and government agencies, because it showed the name of the legal entity in the browser when such a certificate was used. EV certificates are even more expensive, as the background checks are comprehensive.

These aspects of SSL certificates are very valueable in order to determine the credibilty of a publisher. The default setting of the universal payment solution will be that automated payments are only made to publishers with an OV or EV certificate.

